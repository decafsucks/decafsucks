#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "hanami/cli"

# The initial Hanami 2.0.0 release will not officially include database integration. However, much
# of the required work is already done and included in the gem.
#
# This CLI shim activates the database commands so we can manage our app database.

require "hanami/cli/commands/app/db/create"
require "hanami/cli/commands/app/db/create_migration"
require "hanami/cli/commands/app/db/drop"
require "hanami/cli/commands/app/db/migrate"
require "hanami/cli/commands/app/db/setup"
require "hanami/cli/commands/app/db/reset"
require "hanami/cli/commands/app/db/rollback"
require "hanami/cli/commands/app/db/sample_data"
require "hanami/cli/commands/app/db/seed"
require "hanami/cli/commands/app/db/structure/dump"
require "hanami/cli/commands/app/db/version"

Hanami::CLI.tap do |cli|
  cli.register "db create", Hanami::CLI::Commands::App::DB::Create
  cli.register "db create_migration", Hanami::CLI::Commands::App::DB::CreateMigration
  cli.register "db drop", Hanami::CLI::Commands::App::DB::Drop
  cli.register "db migrate", Hanami::CLI::Commands::App::DB::Migrate
  cli.register "db setup", Hanami::CLI::Commands::App::DB::Setup
  cli.register "db reset", Hanami::CLI::Commands::App::DB::Reset
  cli.register "db rollback", Hanami::CLI::Commands::App::DB::Rollback
  cli.register "db sample_data", Hanami::CLI::Commands::App::DB::SampleData
  cli.register "db seed", Hanami::CLI::Commands::App::DB::Seed
  cli.register "db structure dump", Hanami::CLI::Commands::App::DB::Structure::Dump
  cli.register "db version", Hanami::CLI::Commands::App::DB::Version
end

Hanami::CLI::Bundler.require(:cli)

cli = Dry::CLI.new(Hanami::CLI)
cli.call
